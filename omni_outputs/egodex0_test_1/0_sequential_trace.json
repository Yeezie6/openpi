[
  {
    "second": 0,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"right\"]}",
        "parsed_active_hands": [
          "right"
        ]
      },
      "hands": {
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the step-by-step reasoning:\n\n1.  **Analyze the provided context from the video:**\n    *   Opposition Type: Pad (This means the thumb and fingers are opposing each other with their pads).\n    *   Thumb Position: Abd (Abducted, meaning spread away from the palm).\n    *   Virtual Fingers: VF2: 1 vs 2 (This indicates a two-finger grasp, likely index and middle finger, opposing the thumb).\n    *   Object Shape: Cylinder (The object being grasped is cylindrical).\n    *   Contact Region: sidewall (The contact is on the side of the object).\n\n2.  **Analyze the provided reference knowledge snippet:**\n    *   Label: Precision:Inferior_Pincer\n    *   Coarse Type: Precision\n    *   Fine Type: Inferior Pincer\n    *   Opposition: Pad (Matches video context)\n    *   Thumb: Abd (Matches video context)\n    *   Virtual Fingers (VF2): 2 (Matches video context, as \"1 vs 2\" implies two fingers are involved in opposition with the thumb).\n    *   Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder (The \"Cylinder\" object shape matches the video context).\n    *   Contact Region: edge/sidewall (The \"sidewall\" contact region matches the video context).\n\n3.  **Compare the video context with the knowledge snippet:**\n    *   Opposition Type (Pad) matches.\n    *   Thumb Position (Abd) matches.\n    *   Virtual Fingers (VF2: 1 vs 2) matches VF2: 2.\n    *   Object Shape (Cylinder) matches.\n    *   Contact Region (sidewall) matches edge/sidewall.\n\n4.  **Conclusion:** All the key attributes from the video context align perfectly with the \"Precision:Inferior_Pincer\" grasp type described in the knowledge snippet.\n\nFinal Grasp: Precision:Inferior_Pincer",
            "parsed_label": "Precision:Inferior_Pincer"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the right hand with an inferior pincer grasp to pick up a paper cup from the table.",
        "context_str": "\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n"
      }
    }
  },
  {
    "second": 1,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"right\"]}",
        "parsed_active_hands": [
          "right"
        ]
      },
      "hands": {
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2",
              "object_shape": "Cylinder",
              "contact_region": "rim",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n- Object Shape: Cylinder\n- Contact Region: rim\n\nReference Knowledge Snippets:\n- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the step-by-step reasoning:\n\n1.  **Analyze the provided context from the video:**\n    *   Opposition Type: Pad (This means the thumb and fingers are making contact with their pads).\n    *   Thumb Position: Abd (Abducted, meaning spread away from the palm).\n    *   Virtual Fingers (VF2): 1 vs 2 (This indicates that one virtual finger is opposing two virtual fingers. In the context of human hands, this often translates to the thumb opposing two fingers, or one finger opposing two fingers).\n    *   Object Shape: Cylinder (The object being grasped is cylindrical, like a cup).\n    *   Contact Region: rim (The contact is made at the rim of the object).\n\n2.  **Analyze the provided reference knowledge snippet:**\n    *   Label: Precision:Inferior_Pincer\n    *   Coarse Type: Precision\n    *   Fine Type: Inferior Pincer\n    *   Opposition: Pad (Matches video context)\n    *   Thumb: Abd (Matches video context)\n    *   Virtual Fingers (VF2): 2 (This is a mismatch with the video context of \"1 vs 2\". However, the description of \"Inferior Pincer\" often implies a thumb opposing one or two fingers, and the visual context of the hand holding the cup suggests the thumb is opposing the index and middle fingers, which would be 1 vs 2 virtual fingers if we consider the thumb as one and the index/middle as two separate virtual fingers, or 1 vs 1 if we consider the thumb as one and the combined index/middle as another virtual finger. The \"1 vs 2\" in the video context is a bit ambiguous. Let's re-evaluate this. If VF2 refers to the number of *opposing* virtual fingers, then \"1 vs 2\" means one virtual finger opposes two virtual fingers. This aligns with the thumb (1) opposing the index and middle fingers (2). The knowledge snippet says VF2: 2, which is likely referring to the *total* number of virtual fingers involved in the opposition, or the number of fingers opposing the thumb. Given the \"Inferior Pincer\" description, it's more likely that the knowledge snippet's \"VF2: 2\" refers to the two fingers opposing the thumb. The video's \"VF2: 1 vs 2\" is a more precise description of the opposition configuration: thumb (1) vs. index and middle fingers (2). This is a strong match for an inferior pincer grasp where the thumb opposes two fingers.)\n    *   Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder (Matches video context of \"Cylinder\" and \"rim\").\n    *   Contact Region: edge/sidewall (Matches video context of \"rim\").\n\n3.  **Compare video context with knowledge snippets:**\n    *   Opposition Type: Pad (Match)\n    *   Thumb Position: Abd (Match)\n    *   Virtual Fingers (VF2): The video states \"1 vs 2\". The knowledge snippet for \"Precision:Inferior_Pincer\" states \"VF2: 2\". This is consistent with the thumb (1) opposing two fingers (2).\n    *   Object Shape: Cylinder (Match)\n    *   Contact Region: rim (Match)\n\n4.  **Evaluate the \"Precision:Inferior_Pincer\" label:**\n    *   The \"Opposition: Pad\", \"Thumb: Abd\", \"Object Shape: Cylinder\", and \"Contact Region: rim\" all strongly support this grasp.\n    *   The \"Virtual Fingers (VF2): 1 vs 2\" from the video context perfectly describes an inferior pincer grasp where the thumb opposes two fingers. The knowledge snippet's \"VF2: 2\" is likely referring to the two fingers opposing the thumb.\n\n5.  **Consider other possible labels (and why they don't fit):**\n    *   **Power:Large_Diameter:** The grasp is clearly precision-oriented, not power. The object is a cup, not necessarily large diameter in a way that requires power.\n    *   **Power:Ring:** No ring-like object is being grasped.\n    *   **Precision:Prismatic_4_Finger:** This implies a prismatic object and likely four fingers involved in a specific way, which doesn't match the cylindrical cup and the observed thumb-finger opposition.\n    *   **Precision:Inferior_Pincer:** This is the strong candidate.\n    *   **Precision:Precision_Sphere:** The object is a cylinder, not a sphere.\n    *   **Intermediate:Lateral:** Lateral grasps involve the side of the thumb against the side of a finger, which is not what's happening here.\n    *   **Power:Adducted_Thumb:** The thumb is abducted (spread), not adducted.\n\n6.  **Conclusion:** The \"Precision:Inferior_Pincer\" label is the best match based on all provided attributes and the visual evidence. The \"1 vs 2\" virtual finger configuration from the video strongly supports the inferior pincer description.\n\nFinal Answer Derivation:\n- Coarse Type: Precision (from the label and the nature of the grasp)\n- Fine Type: Inferior Pincer (from the label and the opposition configuration)\n\nFinal Grasp: Precision:Inferior_Pincer",
            "parsed_label": "Precision:Inferior_Pincer"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the right hand with an inferior pincer grasp to pick up the rim of a paper cup and place its lid on top.",
        "context_str": "\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n"
      }
    }
  },
  {
    "second": 2,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"right\"]}",
        "parsed_active_hands": [
          "right"
        ]
      },
      "hands": {
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2",
              "object_shape": "Cylinder",
              "contact_region": "rim",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n- Object Shape: Cylinder\n- Contact Region: rim\n\nReference Knowledge Snippets:\n- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the reasoning process:\n\n1.  **Analyze the provided context from the video:**\n    *   Opposition Type: Pad (This refers to how the thumb opposes the fingers, specifically the fleshy pad of the thumb).\n    *   Thumb Position: Abd (Abducted, meaning spread away from the palm).\n    *   Virtual Fingers: VF2: 1 vs 2 (This indicates the number of fingers involved in opposition with the thumb. \"1 vs 2\" suggests one finger opposing two fingers, or a similar configuration where the thumb is opposed by a group of fingers).\n    *   Object Shape: Cylinder (The object being grasped is a cylinder, like a cup).\n    *   Contact Region: rim (The grasp is making contact with the rim of the object).\n\n2.  **Analyze the provided Reference Knowledge Snippets:**\n    *   **Label: Precision:Inferior_Pincer**\n        *   Coarse Type: Precision\n        *   Fine Type: Inferior Pincer\n        *   Opposition: Pad (Matches video context)\n        *   Thumb: Abd (Matches video context)\n        *   Virtual Fingers (VF2): 2 (This is a key differentiator. The video context states \"VF2: 1 vs 2\", which implies a configuration where the thumb opposes a group of fingers. The snippet specifies \"VF2: 2\", which is consistent with the thumb opposing two fingers, or a similar arrangement where the thumb is opposed by multiple fingers).\n        *   Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder (Matches video context for \"Cylinder\" and \"Rim/Edge\").\n        *   Contact Region: edge/sidewall (Matches video context for \"rim\").\n\n3.  **Compare and Match:**\n    *   The video context shows \"Opposition Type: Pad\", \"Thumb Position: Abd\", \"Object Shape: Cylinder\", and \"Contact Region: rim\".\n    *   The \"Precision:Inferior_Pincer\" snippet has matching attributes for \"Opposition: Pad\", \"Thumb: Abd\", \"Object Shape: Cylinder\", and \"Contact Region: edge/sidewall\" (which aligns with \"rim\").\n    *   The \"Virtual Fingers (VF2): 1 vs 2\" from the video context is slightly ambiguous but strongly suggests an opposition involving the thumb and multiple fingers. The snippet's \"VF2: 2\" is consistent with this, implying the thumb opposes two fingers. This configuration is characteristic of an inferior pincer grasp where the thumb opposes the distal phalanges of two fingers.\n\n4.  **Evaluate other potential labels (if any were provided for comparison, but in this case, only one snippet is given as a reference for a specific label):** Since only one detailed snippet is provided, and it matches most of the key attributes from the video context, it's highly likely to be the correct classification. The \"VF2: 1 vs 2\" from the video context, when interpreted in conjunction with the \"VF2: 2\" from the snippet, points towards the thumb opposing two fingers. This is a common configuration for an inferior pincer grasp when holding a cylindrical object by its rim.\n\n5.  **Final Classification:** Based on the strong alignment of attributes, the grasp is classified as \"Precision:Inferior_Pincer\".\n\nFinal Grasp: Precision:Inferior_Pincer",
            "parsed_label": "Precision:Inferior_Pincer"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the right hand with an inferior pincer grasp to place the lid onto the rim of a white paper cup.",
        "context_str": "\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n"
      }
    }
  },
  {
    "second": 3,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"left\", \"right\"]}",
        "parsed_active_hands": [
          "left",
          "right"
        ]
      },
      "hands": {
        "left": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the LEFT HAND (visible on the left side of the image).\n\nTASK:\nInfer the following attributes for the LEFT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the LEFT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the reasoning process:\n\n1.  **Analyze the provided context:**\n    *   Opposition Type: Pad\n    *   Thumb Position: Abd (Abducted)\n    *   Virtual Fingers (VF2): 1 vs 2-5 (This indicates the thumb is opposed by the other four fingers, or at least a significant portion of them).\n    *   Object Shape: Cylinder\n    *   Contact Region: Sidewall\n\n2.  **Analyze the provided knowledge snippets:**\n    *   **Snippet 1: Precision:Prismatic_4_Finger**\n        *   Coarse Type: Precision\n        *   Fine Type: Prismatic 4 Finger\n        *   Opposition: Pad (Matches context)\n        *   Thumb: Abd (Matches context)\n        *   Virtual Fingers (VF2): 2-5 (This is a slight mismatch. The context says \"1 vs 2-5\", which implies the thumb is opposed by fingers 2-5. The snippet says \"2-5\". This is generally consistent with a 4-finger grasp where the thumb opposes the other four fingers).\n        *   Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object (Matches context - Cylinder)\n        *   Contact Region: edge/sidewall/face (Matches context - Sidewall)\n\n    *   **Snippet 2: Precision:Precision_Sphere**\n        *   Coarse Type: Precision\n        *   Fine Type: Precision Sphere\n        *   Opposition: Pad (Matches context)\n        *   Thumb: Abd (Matches context)\n        *   Virtual Fingers (VF2): 2-5 (This is a slight mismatch, similar to the above, but the general idea of thumb opposing other fingers holds).\n        *   Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object (Does NOT match context - Cylinder)\n        *   Contact Region: surface (Does NOT match context - Sidewall)\n\n3.  **Compare context with snippets:**\n    *   The context's \"Opposition Type: Pad\", \"Thumb Position: Abd\", \"Object Shape: Cylinder\", and \"Contact Region: Sidewall\" are all key discriminators.\n    *   Snippet 1 (\"Precision:Prismatic_4_Finger\") matches all these key discriminators: Opposition (Pad), Thumb (Abd), Object Shape (Cylinder), and Contact Region (Sidewall). The VF2 description is also consistent with a 4-finger grasp.\n    *   Snippet 2 (\"Precision:Precision_Sphere\") fails to match the Object Shape (Cylinder vs. Sphere/Ellipsoid) and Contact Region (Sidewall vs. Surface).\n\n4.  **Conclusion:** Snippet 1 is the best match. The grasp is a Precision grasp, and the fine type is Prismatic 4 Finger because it involves opposition of the thumb with the other fingers (VF2: 1 vs 2-5 implies thumb vs. other fingers) to grasp a cylindrical object by its sidewall.\n\n5.  **Format the output:** The required format is \"Final Grasp: Coarse:Fine\".\n\nFinal Grasp: Precision:Prismatic_4_Finger",
            "parsed_label": "Precision:Prismatic_4_Finger"
          }
        },
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the reasoning process:\n\n1.  **Analyze the provided context:**\n    *   Opposition Type: Pad\n    *   Thumb Position: Abd (Abducted)\n    *   Virtual Fingers (VF2): 1 vs 2-5 (This indicates the thumb is opposed by the other four fingers, or at least a significant portion of them).\n    *   Object Shape: Cylinder\n    *   Contact Region: Sidewall\n\n2.  **Analyze the provided knowledge snippets:**\n    *   **Snippet 1: Precision:Prismatic_4_Finger**\n        *   Coarse Type: Precision\n        *   Fine Type: Prismatic 4 Finger\n        *   Opposition: Pad (Matches context)\n        *   Thumb: Abd (Matches context)\n        *   Virtual Fingers (VF2): 2-5 (This is a slight mismatch. The context says \"1 vs 2-5\", which implies the thumb is opposed by fingers 2-5. The snippet says \"2-5\". This is generally consistent with a 4-finger grasp where the thumb opposes the other four fingers).\n        *   Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object (Matches context - Cylinder)\n        *   Contact Region: edge/sidewall/face (Matches context - Sidewall)\n\n    *   **Snippet 2: Precision:Precision_Sphere**\n        *   Coarse Type: Precision\n        *   Fine Type: Precision Sphere\n        *   Opposition: Pad (Matches context)\n        *   Thumb: Abd (Matches context)\n        *   Virtual Fingers (VF2): 2-5 (This is a slight mismatch, similar to the above, but the general idea of thumb opposing other fingers holds).\n        *   Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object (Does NOT match context - Cylinder)\n        *   Contact Region: surface (Does NOT match context - Sidewall)\n\n3.  **Compare context with snippets:**\n    *   The context's \"Opposition Type: Pad\", \"Thumb Position: Abd\", \"Object Shape: Cylinder\", and \"Contact Region: Sidewall\" are all key discriminators.\n    *   Snippet 1 (\"Precision:Prismatic_4_Finger\") matches all these key discriminators: Opposition (Pad), Thumb (Abd), Object Shape (Cylinder), and Contact Region (Sidewall). The VF2 description is also consistent with a 4-finger grasp.\n    *   Snippet 2 (\"Precision:Precision_Sphere\") fails to match the Object Shape (Cylinder vs. Sphere/Ellipsoid) and Contact Region (Sidewall vs. Surface).\n\n4.  **Conclusion:** Snippet 1 is the best match. The grasp is a Precision grasp, and the fine type is Prismatic 4 Finger because it involves opposition of the thumb with the other fingers (VF2: 1 vs 2-5 implies thumb vs. other fingers) to grasp a cylindrical object by its sidewall.\n\n5.  **Format the output:** The required format is \"Final Grasp: Coarse:Fine\".\n\nFinal Grasp: Precision:Prismatic_4_Finger",
            "parsed_label": "Precision:Prismatic_4_Finger"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (left and right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the left hand with a prismatic 4 finger grasp to pick up the rim of a paper cup and use the right hand with a prismatic 4 finger grasp to place a lid onto the cup.",
        "context_str": "\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n"
      }
    }
  },
  {
    "second": 4,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"left\", \"right\"]}",
        "parsed_active_hands": [
          "left",
          "right"
        ]
      },
      "hands": {
        "left": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the LEFT HAND (visible on the left side of the image).\n\nTASK:\nInfer the following attributes for the LEFT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the LEFT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder",
              "contact_region": "rim",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: rim\n\nReference Knowledge Snippets:\n- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is holding a paper cup.\nThe opposition type is 'Pad', meaning the thumb pad is used for opposition.\nThe thumb position is 'Abd', meaning the thumb is abducted (moved away from the palm).\nThe virtual fingers are described as 'VF2: 1 vs 2-5', which implies the thumb is opposed by the other four fingers.\nThe object shape is 'Cylinder'.\nThe contact region is 'rim'.\n\nLet's evaluate the provided knowledge snippets:\n\n1.  **Label: Precision:Prismatic_4_Finger**\n    *   Coarse Type: Precision - Matches the general idea of a precise grasp.\n    *   Fine Type: Prismatic 4 Finger - The object is a cylinder, which can be considered prismatic. The grasp involves the thumb and other fingers.\n    *   Opposition: Pad - Matches the provided context.\n    *   Thumb: Abd - Matches the provided context.\n    *   Virtual Fingers (VF2): 2-5 - This is a key differentiator. The provided context states 'VF2: 1 vs 2-5', which means the thumb (1) is opposed by fingers 2-5. This snippet's VF2 attribute is '2-5', which implies the fingers 2-5 are involved in opposition, but it doesn't explicitly state the thumb is opposed by *all* of them. However, the description \"1 vs 2-5\" strongly suggests the thumb is opposed by the collective action of fingers 2-5.\n    *   Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object - 'Cylinder' is listed as a valid object shape.\n    *   Contact Region: edge/sidewall/face - The provided context states 'rim'. The rim of a cylinder is an edge. This is a close match.\n\n2.  **Label: Precision:Precision_Sphere**\n    *   Coarse Type: Precision - Matches.\n    *   Fine Type: Precision Sphere - The object is a cylinder, not a sphere. This does not match.\n    *   Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object - 'Cylinder' is not listed. This does not match.\n\nBased on the analysis, **Precision:Prismatic_4_Finger** is the best match. The grasp involves the thumb and other fingers opposing each other to hold a cylindrical object by its rim. The 'VF2: 1 vs 2-5' description aligns with the thumb being opposed by the collective action of the other fingers, which is characteristic of a 4-finger grasp in this context. The contact region 'rim' is consistent with the 'edge' contact region for a cylinder.\n\nFinal check:\n- Opposition Type: Pad (Matches)\n- Thumb Position: Abd (Matches)\n- Virtual Fingers: VF2: 1 vs 2-5 (Implies thumb opposed by fingers 2-5, consistent with Prismatic_4_Finger)\n- Object Shape: Cylinder (Matches)\n- Contact Region: rim (Matches edge/rim of a cylinder)\n\nAll key attributes align with Precision:Prismatic_4_Finger.\n\nFinal Grasp: Precision:Prismatic_4_Finger",
            "parsed_label": "Precision:Prismatic_4_Finger"
          }
        },
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder, Rim\",\n  \"contact_region\": \"rim, sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder, Rim",
              "contact_region": "rim, sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder, Rim\",\n  \"contact_region\": \"rim, sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder, Rim\n- Contact Region: rim, sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is interacting with a cylindrical object (a cup). The grasp involves opposition by the pad of the thumb and fingers. The thumb is abducted. The virtual fingers are described as VF2: 1 vs 2-5, indicating that the thumb (VF1) is opposed to the other fingers (VF2-5). The contact region is the rim and sidewall of the cylinder.\n\nLet's evaluate the provided labels:\n\n1.  **Precision:Prismatic_4_Finger**:\n    *   Coarse Type: Precision (Matches)\n    *   Fine Type: Prismatic 4 Finger (The object is a cylinder, which can be considered a round object, and the grasp is likely using multiple fingers for precision. The \"Prismatic\" part might be a slight mismatch if strictly interpreted as prismatic shapes, but cylinders are often grouped with round objects in grasp taxonomies.)\n    *   Opposition: Pad (Matches)\n    *   Thumb: Abd (Matches)\n    *   Virtual Fingers (VF2): 2-5 (Matches the description \"VF2: 1 vs 2-5\" where VF1 is the thumb and VF2-5 are the other fingers.)\n    *   Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object (Matches \"Cylinder\")\n    *   Contact Region: edge/sidewall/face (Matches \"rim\" and \"sidewall\")\n\n2.  **Precision:Precision_Sphere**:\n    *   Coarse Type: Precision (Matches)\n    *   Fine Type: Precision Sphere (The object is a cylinder, not a sphere. This is a mismatch.)\n    *   Opposition: Pad (Matches)\n    *   Thumb: Abd (Matches)\n    *   Virtual Fingers (VF2): 2-5 (Matches)\n    *   Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object (Mismatch - object is a cylinder)\n    *   Contact Region: surface (The contact is on the rim and sidewall, which is a surface, but the object shape is the primary mismatch here.)\n\nComparing the two, **Precision:Prismatic_4_Finger** is a much better fit because the object shape (Cylinder) and contact region (rim, sidewall) align well with the knowledge snippet for this label. While the object is not strictly prismatic, cylinders are often categorized alongside prismatic and round objects in grasp taxonomies, and the other attributes (opposition, thumb position, virtual fingers, contact region) are a strong match. The \"Prismatic 4 Finger\" part implies a precision grasp using multiple fingers, which is consistent with how one would hold a cup.\n\nThe provided context \"VF2: 1 vs 2-5\" strongly suggests that the thumb is opposed to the other four fingers, which is characteristic of a precision grasp. The object is a cylinder, and the contact is on the rim and sidewall.\n\nLet's re-examine the \"Fine Type\" for Precision:Prismatic_4_Finger. The knowledge snippet lists \"Cylinder, Round Object\" under Object Shape. This suggests that this grasp type can apply to cylinders. The \"Prismatic 4 Finger\" part likely refers to the configuration of the fingers, where they are used in a way that could also grasp prismatic objects, but is also applicable to cylinders in a precision manner.\n\nGiven the strong alignment of all other attributes and the inclusion of \"Cylinder\" in the object shape for Precision:Prismatic_4_Finger, this is the most appropriate classification.\n\nFinal check:\n- Opposition Type: Pad (Matches Precision:Prismatic_4_Finger)\n- Thumb Position: Abd (Matches Precision:Prismatic_4_Finger)\n- Virtual Fingers: VF2: 1 vs 2-5 (Matches Precision:Prismatic_4_Finger where VF2 is 2-5)\n- Object Shape: Cylinder (Matches Precision:Prismatic_4_Finger)\n- Contact Region: rim, sidewall (Matches Precision:Prismatic_4_Finger)\n\nAll key attributes align with Precision:Prismatic_4_Finger.\n\nFinal Grasp: Precision:Prismatic_4_Finger",
            "parsed_label": "Precision:Prismatic_4_Finger"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (left and right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the left hand with a prismatic 4 finger grasp to pick up the rim of a white paper cup and use the right hand with a prismatic 4 finger grasp to place a lid onto the cup.",
        "context_str": "\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n"
      }
    }
  },
  {
    "second": 5,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"left\", \"right\"]}",
        "parsed_active_hands": [
          "left",
          "right"
        ]
      },
      "hands": {
        "left": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the LEFT HAND (visible on the left side of the image).\n\nTASK:\nInfer the following attributes for the LEFT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the LEFT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Palm\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Palm",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Palm\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Palm\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Power:Large_Diameter\n  Coarse Type: Power\n  Fine Type: Large Diameter\n  Opposition: Palm\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cylinder, Tapered Cylinder, Cuboid/Prismatic, Handle, Ring, Torus, Ring-Plate, Rim/Edge\n  Contact Region: sidewall/rim\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Power:Large_Diameter\n  Coarse Type: Power\n  Fine Type: Large Diameter\n  Opposition: Palm\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cylinder, Tapered Cylinder, Cuboid/Prismatic, Handle, Ring, Torus, Ring-Plate, Rim/Edge\n  Contact Region: sidewall/rim",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's a step-by-step reasoning process:\n\n1.  **Analyze the provided context from the video:**\n    *   **Opposition Type:** Palm. This indicates the palm is involved in the grasp.\n    *   **Thumb Position:** Abd (Abducted). The thumb is spread away from the palm.\n    *   **Virtual Fingers (VF2):** VF2: 1 vs 2-5. This means one virtual finger (likely the thumb) is opposed to the other four virtual fingers (index, middle, ring, and pinky).\n    *   **Object Shape:** Cylinder. The object being grasped is cylindrical.\n    *   **Contact Region:** Sidewall. The contact is on the side of the object.\n\n2.  **Analyze the provided reference knowledge snippet for \"Power:Large_Diameter\":**\n    *   **Coarse Type:** Power.\n    *   **Fine Type:** Large Diameter.\n    *   **Opposition:** Palm. (Matches video context)\n    *   **Thumb:** Abd. (Matches video context)\n    *   **Virtual Fingers (VF2):** 2-5. This means the other fingers (index, middle, ring, pinky) are involved in the grasp, opposing the thumb. The video context states \"VF2: 1 vs 2-5\", which implies the thumb (1) is opposed to the other fingers (2-5). This aligns with the \"Power:Large_Diameter\" description where the fingers wrap around the object.\n    *   **Object Shape:** Cylinder, Tapered Cylinder, Cuboid/Prismatic, Handle, Ring, Torus, Ring-Plate, Rim/Edge. (Cylinder matches video context)\n    *   **Contact Region:** Sidewall/rim. (Sidewall matches video context)\n\n3.  **Compare the video context with the knowledge snippet:**\n    *   Opposition Type: Palm (Match)\n    *   Thumb Position: Abd (Match)\n    *   Virtual Fingers: The video context \"VF2: 1 vs 2-5\" implies the thumb is opposed to the other fingers. The knowledge snippet for \"Power:Large_Diameter\" lists \"VF2: 2-5\", which means the other fingers are involved. This is consistent with a power grasp where fingers wrap around the object.\n    *   Object Shape: Cylinder (Match)\n    *   Contact Region: Sidewall (Match)\n\n4.  **Evaluate other potential grasp types (though only one is provided for comparison):**\n    *   The provided context strongly aligns with the \"Power:Large_Diameter\" grasp. The palm is involved, the thumb is abducted, the object is a cylinder, and the contact is on the sidewall. This type of grasp is used for larger objects where force is applied. The visual shows the hand wrapping around the cup, which is characteristic of a power grasp on a large diameter object.\n\n5.  **Conclusion:** All the provided attributes from the video context perfectly match the criteria for the \"Power:Large_Diameter\" grasp as described in the knowledge snippet.\n\nFinal Grasp: Power:Large_Diameter",
            "parsed_label": "Power:Large_Diameter"
          }
        },
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the step-by-step reasoning:\n\n1.  **Analyze the provided context from the video:**\n    *   Opposition Type: Pad\n    *   Thumb Position: Abd (Abducted)\n    *   Virtual Fingers (VF2): 1 vs 2 (This indicates the number of fingers on each side of the object. In this case, it implies one side has 1 finger and the other has 2 fingers, or a similar configuration where the fingers are distributed across the object's circumference).\n    *   Object Shape: Cylinder\n    *   Contact Region: sidewall\n\n2.  **Analyze the provided reference knowledge snippet for \"Precision:Inferior_Pincer\":**\n    *   Coarse Type: Precision\n    *   Fine Type: Inferior Pincer\n    *   Opposition: Pad (Matches video context)\n    *   Thumb: Abd (Matches video context)\n    *   Virtual Fingers (VF2): 2 (This is a slight discrepancy with the video context \"1 vs 2\". However, \"Inferior Pincer\" often involves the thumb and one or two fingers. The \"1 vs 2\" could be interpreted as the thumb (1) opposing the fingers (2) or vice-versa, or a combination. Given the other strong matches, this might be a flexible interpretation or a slight difference in how VF2 is reported).\n    *   Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder (Matches video context \"Cylinder\")\n    *   Contact Region: edge/sidewall (Matches video context \"sidewall\")\n\n3.  **Compare the video context with the knowledge snippet:**\n    *   Opposition Type: \"Pad\" matches.\n    *   Thumb Position: \"Abd\" matches.\n    *   Object Shape: \"Cylinder\" matches.\n    *   Contact Region: \"sidewall\" matches \"edge/sidewall\".\n    *   Virtual Fingers (VF2): The video states \"1 vs 2\", while the knowledge snippet states \"2\". This is the only point of potential divergence. However, the \"Inferior Pincer\" grasp typically involves the thumb and one or two fingers opposing each other. The \"1 vs 2\" could be interpreted as the thumb (1) and two fingers (2) on the other side, or a similar arrangement. Given the strong alignment on other key features (Opposition, Thumb Position, Object Shape, Contact Region), and that \"Inferior Pincer\" is a plausible grasp for a cylinder using the sidewall with thumb opposition, this is the most likely match.\n\n4.  **Evaluate other possible grasps (internal check):**\n    *   Power:Large_Diameter: Unlikely, as the context points to precision.\n    *   Power:Ring: Unlikely, as the object is a cylinder and the grasp doesn't appear to be a ring grasp.\n    *   Precision:Prismatic_4_Finger: Unlikely, as the object is a cylinder and the grasp doesn't seem to involve all four fingers in a prismatic manner.\n    *   Precision:Inferior_Pincer: Strong match based on the analysis above.\n    *   Precision:Precision_Sphere: Unlikely, as the object is a cylinder, not a sphere.\n    *   Intermediate:Lateral: Unlikely, as the context points to precision and opposition.\n    *   Power:Adducted_Thumb: Unlikely, as the thumb is described as \"Abd\" (abducted).\n\n5.  **Conclusion:** The \"Precision:Inferior_Pincer\" grasp is the best match due to the strong alignment of Opposition Type, Thumb Position, Object Shape, and Contact Region. The VF2 discrepancy is minor and can be reconciled with the typical configuration of an inferior pincer grasp.\n\nFinal Grasp: Precision:Inferior_Pincer",
            "parsed_label": "Precision:Inferior_Pincer"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (left and right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Large_Diameter\n- Grasp Taxonomy (natural): large diameter\n- Opposition: Palm\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the left hand with a large diameter grasp to pick up the base of a white cup and use the right hand with an inferior pincer grasp to pick up the lid of another white cup.",
        "context_str": "\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Large_Diameter\n- Grasp Taxonomy (natural): large diameter\n- Opposition: Palm\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n"
      }
    }
  },
  {
    "second": 6,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"left\", \"right\"]}",
        "parsed_active_hands": [
          "left",
          "right"
        ]
      },
      "hands": {
        "left": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the LEFT HAND (visible on the left side of the image).\n\nTASK:\nInfer the following attributes for the LEFT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the LEFT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the reasoning process:\n\n1.  **Analyze the Visual Context:**\n    *   The hand is holding a white paper cup.\n    *   The thumb is abducted (spread away from the palm).\n    *   The fingers are wrapped around the sidewall of the cup.\n    *   The opposition type appears to be pad-to-pad or pad-to-side.\n    *   The object is cylindrical.\n\n2.  **Analyze the Provided Contextual Information:**\n    *   Opposition Type: Pad\n    *   Thumb Position: Abd (Abducted)\n    *   Virtual Fingers: VF2: 1 vs 2-5 (This indicates the thumb is opposing the other four fingers, or at least a group of them).\n    *   Object Shape: Cylinder\n    *   Contact Region: sidewall\n\n3.  **Evaluate the Reference Knowledge Snippets:**\n\n    *   **Label: Precision:Prismatic_4_Finger**\n        *   Coarse Type: Precision - Matches the general idea of a controlled grasp.\n        *   Fine Type: Prismatic 4 Finger - The object is cylindrical, which can be considered a type of prismatic object in a broader sense, or at least a shape that can be grasped with multiple fingers.\n        *   Opposition: Pad - Matches the visual context.\n        *   Thumb: Abd - Matches the visual context.\n        *   Virtual Fingers (VF2): 2-5 - This is a key differentiator. The provided context states \"VF2: 1 vs 2-5\", which means the thumb (1) is opposing the other fingers (2-5). This snippet also lists \"VF2: 2-5\". This is a strong match.\n        *   Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object - \"Cylinder\" is explicitly listed. This is a strong match.\n        *   Contact Region: edge/sidewall/face - \"sidewall\" is explicitly listed. This is a strong match.\n\n    *   **Label: Precision:Precision_Sphere**\n        *   Coarse Type: Precision - Matches.\n        *   Fine Type: Precision Sphere - The object is a cylinder, not a sphere. This is a mismatch.\n        *   Opposition: Pad - Matches.\n        *   Thumb: Abd - Matches.\n        *   Virtual Fingers (VF2): 2-5 - Matches.\n        *   Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object - \"Cylinder\" is not listed. This is a mismatch.\n        *   Contact Region: surface - While the sidewall is a surface, the \"sidewall\" is more specific and matches the other snippet better.\n\n4.  **Compare and Select the Best Match:**\n    *   The \"Precision:Prismatic_4_Finger\" label aligns perfectly with all the provided contextual information: Opposition (Pad), Thumb Position (Abd), Virtual Fingers (1 vs 2-5, which implies opposition of thumb to other fingers), Object Shape (Cylinder), and Contact Region (sidewall).\n    *   The \"Precision:Precision_Sphere\" label is a clear mismatch due to the object shape.\n\n5.  **Determine the Final Output Format:** The output must be \"Coarse:Fine\".\n\n    *   From the selected label \"Precision:Prismatic_4_Finger\", the Coarse Type is \"Precision\" and the Fine Type is \"Prismatic_4_Finger\".\n\nFinal Answer Derivation:\nThe visual context and provided attributes (Opposition Type: Pad, Thumb Position: Abd, Virtual Fingers: VF2: 1 vs 2-5, Object Shape: Cylinder, Contact Region: sidewall) strongly match the knowledge snippet for \"Precision:Prismatic_4_Finger\". The \"VF2: 1 vs 2-5\" indicates the thumb opposing the other fingers, which is consistent with the visual. The object shape being a cylinder and the contact region being the sidewall are also direct matches.\n\nFinal Grasp: Precision:Prismatic_4_Finger",
            "parsed_label": "Precision:Prismatic_4_Finger"
          }
        },
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's the reasoning process:\n\n1.  **Analyze the provided context from the video:**\n    *   Opposition Type: Pad (This means the thumb pad is used for opposition).\n    *   Thumb Position: Abd (Thumb is abducted, meaning it's spread away from the palm).\n    *   Virtual Fingers: VF2: 1 vs 2 (This indicates a two-finger grasp where one finger opposes the thumb, and the other finger is also involved, or it could imply a two-finger opposition).\n    *   Object Shape: Cylinder (The object being grasped is cylindrical, like a cup).\n    *   Contact Region: sidewall (The contact is on the side of the object).\n\n2.  **Analyze the provided reference knowledge snippet:**\n    *   Label: Precision:Inferior_Pincer\n    *   Coarse Type: Precision\n    *   Fine Type: Inferior Pincer\n    *   Opposition: Pad (Matches video context)\n    *   Thumb: Abd (Matches video context)\n    *   Virtual Fingers (VF2): 2 (This is a key match. The video context states \"VF2: 1 vs 2\", which implies a two-finger configuration, and the knowledge snippet specifies \"VF2: 2\". This suggests the grasp involves two fingers opposing the thumb, or a similar configuration that results in a \"2\" for VF2. The \"1 vs 2\" in the video context might be interpreted as one virtual finger (thumb) opposing another virtual finger (or fingers) that collectively represent the other digits. Given the options, VF2: 2 is the closest match to the visual representation of a pincer-like grasp.)\n    *   Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder (Matches video context: Cylinder)\n    *   Contact Region: edge/sidewall (Matches video context: sidewall)\n\n3.  **Compare video context with available grasp labels:**\n    *   **Power:Large_Diameter**: Not a power grasp, and the object doesn't necessarily imply a large diameter requiring power.\n    *   **Power:Ring**: Not a power grasp, and the object is not being grasped in a ring-like manner.\n    *   **Precision:Prismatic_4_Finger**: The video context suggests a 2-finger opposition (VF2: 1 vs 2, likely meaning thumb vs. two fingers or thumb and one finger vs. another finger). This doesn't fit a 4-finger grasp.\n    *   **Precision:Inferior_Pincer**:\n        *   Coarse Type: Precision (Matches the nature of the grasp, which appears to be precise rather than power-based).\n        *   Fine Type: Inferior Pincer (This type of grasp typically involves the thumb and one or two fingers opposing each other to grasp a small object or a part of a larger object. The visual shows the thumb and at least one finger (likely two) on the sidewall of the cylinder. The \"VF2: 1 vs 2\" strongly suggests this configuration.)\n        *   Opposition: Pad (Matches)\n        *   Thumb: Abd (Matches)\n        *   VF2: 2 (Matches the interpretation of \"1 vs 2\" in the context of pincer grasps where the thumb is one component and the opposing digits are the other. The knowledge snippet explicitly states VF2: 2 for this grasp.)\n        *   Object Shape: Cylinder (Matches)\n        *   Contact Region: sidewall (Matches)\n    *   **Precision:Precision_Sphere**: The object is a cylinder, not a sphere.\n    *   **Intermediate:Lateral**: Lateral grasps involve the thumb pad or side of the thumb pressing against the side of an object, often with fingers providing support. While there's contact on the sidewall, the opposition with fingers suggests a pincer grasp rather than a purely lateral grasp.\n    *   **Power:Adducted_Thumb**: The thumb is abducted (Abd), not adducted.\n\n4.  **Conclusion:** The \"Precision:Inferior_Pincer\" label aligns perfectly with all the provided context and the reference knowledge snippet. The opposition type (Pad), thumb position (Abd), virtual fingers (VF2: 2, inferred from \"1 vs 2\" and the knowledge snippet), object shape (Cylinder), and contact region (sidewall) all match.\n\nFinal Answer Derivation:\nThe provided context attributes (Opposition Type: Pad, Thumb Position: Abd, Virtual Fingers: VF2: 1 vs 2, Object Shape: Cylinder, Contact Region: sidewall) strongly match the reference knowledge snippet for \"Precision:Inferior_Pincer\" (Opposition: Pad, Thumb: Abd, VF2: 2, Object Shape: Cylinder, Contact Region: edge/sidewall). The \"VF2: 1 vs 2\" in the video context is interpreted as the thumb (one virtual finger) opposing the other digits (represented as two virtual fingers in the knowledge snippet for this grasp type).\n\nFinal Grasp: Precision:Inferior_Pincer",
            "parsed_label": "Precision:Inferior_Pincer"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (left and right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the left hand with a prismatic 4 finger grasp to hold the body of a white paper cup and use the right hand with an inferior pincer grasp to place the lid onto the cup.",
        "context_str": "\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n"
      }
    }
  },
  {
    "second": 7,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"left\", \"right\"]}",
        "parsed_active_hands": [
          "left",
          "right"
        ]
      },
      "hands": {
        "left": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the LEFT HAND (visible on the left side of the image).\n\nTASK:\nInfer the following attributes for the LEFT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the LEFT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's a step-by-step reasoning process:\n\n1.  **Analyze the provided context from the video:**\n    *   **Opposition Type:** Pad. This means the thumb and fingers are making contact with their fleshy pads.\n    *   **Thumb Position:** Abd (Abducted). The thumb is spread away from the palm.\n    *   **Virtual Fingers (VF2):** 1 vs 2. This indicates that one virtual finger (likely the thumb) is opposing two virtual fingers (likely index and middle fingers).\n    *   **Object Shape:** Cylinder. The object being grasped is cylindrical.\n    *   **Contact Region:** Sidewall. The contact is made on the side of the object.\n\n2.  **Analyze the provided reference knowledge snippet:**\n    *   **Label:** Precision:Inferior_Pincer\n    *   **Coarse Type:** Precision\n    *   **Fine Type:** Inferior Pincer\n    *   **Opposition:** Pad (Matches video context)\n    *   **Thumb:** Abd (Matches video context)\n    *   **Virtual Fingers (VF2):** 2 (This is a discrepancy. The video context states \"1 vs 2\", which implies the thumb is one virtual finger and the opposing fingers are two. The knowledge snippet states \"VF2: 2\". This usually refers to the number of *opposing* virtual fingers. If VF2 refers to the *total* number of virtual fingers involved in the opposition, then \"1 vs 2\" would mean 3 total, which doesn't fit. However, in grasp taxonomy, VF2 often refers to the number of fingers opposing the thumb. So, \"1 vs 2\" means 1 thumb opposing 2 fingers. The knowledge snippet's \"VF2: 2\" likely refers to the two fingers opposing the thumb.)\n    *   **Object Shape:** Cylinder (Matches video context)\n    *   **Contact Region:** edge/sidewall (Matches video context's \"sidewall\")\n\n3.  **Compare context with knowledge snippet:**\n    *   Opposition Type: Pad (Match)\n    *   Thumb Position: Abd (Match)\n    *   Object Shape: Cylinder (Match)\n    *   Contact Region: Sidewall (Match)\n    *   Virtual Fingers (VF2): The video context \"1 vs 2\" strongly suggests a grasp where the thumb opposes two fingers. The knowledge snippet's \"VF2: 2\" aligns with this interpretation, meaning two fingers are opposing the thumb. This is characteristic of an inferior pincer grasp.\n\n4.  **Evaluate the \"Precision:Inferior_Pincer\" label:**\n    *   **Coarse Type: Precision:** This is a precision grasp because it involves fine motor control and opposition of digits to manipulate a smaller object or a specific part of an object. The context of using pads for opposition and the specific finger/thumb configuration points to precision.\n    *   **Fine Type: Inferior Pincer:** An inferior pincer grasp typically involves the thumb pad opposing the pads of the index and middle fingers, often used for cylindrical objects or objects with a rim. The \"1 vs 2\" virtual finger configuration, pad opposition, and sidewall contact on a cylinder are all consistent with an inferior pincer grasp.\n\n5.  **Consider other possible labels (and why they don't fit):**\n    *   **Power:Large_Diameter:** This is a power grasp, not precision. The object is a cup, which could be considered large, but the *manner* of grasping (pad opposition, specific finger configuration) is precision-oriented.\n    *   **Power:Ring:** This is a power grasp, typically around a ring-shaped object. Not applicable here.\n    *   **Precision:Prismatic_4_Finger:** This involves four fingers and a thumb, often for prismatic objects. The \"1 vs 2\" virtual finger configuration doesn't fit.\n    *   **Precision:Inferior_Pincer:** This is the candidate.\n    *   **Precision:Precision_Sphere:** This is for spherical objects. The object is a cylinder.\n    *   **Intermediate:Lateral:** This involves the side of the thumb against the side of a finger. The context indicates pad opposition.\n    *   **Power:Adducted_Thumb:** This is a power grasp with the thumb adducted (tucked in). The context states the thumb is abducted.\n\n6.  **Conclusion:** All the provided contextual cues (Opposition Type: Pad, Thumb Position: Abd, Virtual Fingers: 1 vs 2, Object Shape: Cylinder, Contact Region: Sidewall) strongly align with the characteristics of the \"Precision:Inferior_Pincer\" grasp as described in the reference knowledge snippet. The \"VF2: 2\" in the knowledge snippet, when interpreted as the number of opposing fingers, confirms this.\n\nFinal Answer should be in the format \"Coarse:Fine\".\n\nFinal Grasp: Precision:Inferior_Pincer",
            "parsed_label": "Precision:Inferior_Pincer"
          }
        },
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2",
              "object_shape": "Cylinder",
              "contact_region": "sidewall",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"sidewall\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n- Object Shape: Cylinder\n- Contact Region: sidewall\n\nReference Knowledge Snippets:\n- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Inferior_Pincer\n  Coarse Type: Precision\n  Fine Type: Inferior Pincer\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2\n  Object Shape: Small Feature/Edge, Tab/Pull-Tab, Rim/Edge, Cavity/Hole, Cylinder\n  Contact Region: edge/sidewall",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is asking to classify a grasp based on visual context and provided knowledge snippets.\n\nHere's a step-by-step reasoning process:\n\n1.  **Analyze the provided context from the video:**\n    *   **Opposition Type:** Pad. This means the thumb and fingers are making contact with their fleshy pads.\n    *   **Thumb Position:** Abd (Abducted). The thumb is spread away from the palm.\n    *   **Virtual Fingers (VF2):** 1 vs 2. This indicates that one virtual finger (likely the thumb) is opposing two virtual fingers (likely index and middle fingers).\n    *   **Object Shape:** Cylinder. The object being grasped is cylindrical.\n    *   **Contact Region:** Sidewall. The contact is made on the side of the object.\n\n2.  **Analyze the provided reference knowledge snippet:**\n    *   **Label:** Precision:Inferior_Pincer\n    *   **Coarse Type:** Precision\n    *   **Fine Type:** Inferior Pincer\n    *   **Opposition:** Pad (Matches video context)\n    *   **Thumb:** Abd (Matches video context)\n    *   **Virtual Fingers (VF2):** 2 (This is a discrepancy. The video context states \"1 vs 2\", which implies the thumb is one virtual finger and the opposing fingers are two. The knowledge snippet states \"VF2: 2\". This usually refers to the number of *opposing* virtual fingers. If VF2 refers to the *total* number of virtual fingers involved in the opposition, then \"1 vs 2\" would mean 3 total, which doesn't fit. However, in grasp taxonomy, VF2 often refers to the number of fingers opposing the thumb. So, \"1 vs 2\" means 1 thumb opposing 2 fingers. The knowledge snippet's \"VF2: 2\" likely refers to the two fingers opposing the thumb.)\n    *   **Object Shape:** Cylinder (Matches video context)\n    *   **Contact Region:** edge/sidewall (Matches video context's \"sidewall\")\n\n3.  **Compare context with knowledge snippet:**\n    *   Opposition Type: Pad (Match)\n    *   Thumb Position: Abd (Match)\n    *   Object Shape: Cylinder (Match)\n    *   Contact Region: Sidewall (Match)\n    *   Virtual Fingers (VF2): The video context \"1 vs 2\" strongly suggests a grasp where the thumb opposes two fingers. The knowledge snippet's \"VF2: 2\" aligns with this interpretation, meaning two fingers are opposing the thumb. This is characteristic of an inferior pincer grasp.\n\n4.  **Evaluate the \"Precision:Inferior_Pincer\" label:**\n    *   **Coarse Type: Precision:** This is a precision grasp because it involves fine motor control and opposition of digits to manipulate a smaller object or a specific part of an object. The context of using pads for opposition and the specific finger/thumb configuration points to precision.\n    *   **Fine Type: Inferior Pincer:** An inferior pincer grasp typically involves the thumb pad opposing the pads of the index and middle fingers, often used for cylindrical objects or objects with a rim. The \"1 vs 2\" virtual finger configuration, pad opposition, and sidewall contact on a cylinder are all consistent with an inferior pincer grasp.\n\n5.  **Consider other possible labels (and why they don't fit):**\n    *   **Power:Large_Diameter:** This is a power grasp, not precision. The object is a cup, which could be considered large, but the *manner* of grasping (pad opposition, specific finger configuration) is precision-oriented.\n    *   **Power:Ring:** This is a power grasp, typically around a ring-shaped object. Not applicable here.\n    *   **Precision:Prismatic_4_Finger:** This involves four fingers and a thumb, often for prismatic objects. The \"1 vs 2\" virtual finger configuration doesn't fit.\n    *   **Precision:Inferior_Pincer:** This is the candidate.\n    *   **Precision:Precision_Sphere:** This is for spherical objects. The object is a cylinder.\n    *   **Intermediate:Lateral:** This involves the side of the thumb against the side of a finger. The context indicates pad opposition.\n    *   **Power:Adducted_Thumb:** This is a power grasp with the thumb adducted (tucked in). The context states the thumb is abducted.\n\n6.  **Conclusion:** All the provided contextual cues (Opposition Type: Pad, Thumb Position: Abd, Virtual Fingers: 1 vs 2, Object Shape: Cylinder, Contact Region: Sidewall) strongly align with the characteristics of the \"Precision:Inferior_Pincer\" grasp as described in the reference knowledge snippet. The \"VF2: 2\" in the knowledge snippet, when interpreted as the number of opposing fingers, confirms this.\n\nFinal Answer should be in the format \"Coarse:Fine\".\n\nFinal Grasp: Precision:Inferior_Pincer",
            "parsed_label": "Precision:Inferior_Pincer"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (left and right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the left hand with an inferior pincer grasp to pick up the lid of a white cup and use the right hand with an inferior pincer grasp to pick up the white cup.",
        "context_str": "\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Inferior_Pincer\n- Grasp Taxonomy (natural): inferior pincer\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2\n"
      }
    }
  },
  {
    "second": 8,
    "trace": {
      "detect": {
        "system_prompt": "You are an expert in analyzing human hand-object interactions in first-person videos.\nThe left side of the video frame corresponds to the Left Hand. The right side corresponds to the Right Hand.\n\nRULES:\n1. Analyze the video and determine which hands are actively manipulating an object.\n2. Ignore hands that are visible but NOT interacting with any object.\n3. Output format: A single JSON object with the key \"active_hands\" containing a list of strings (allowed: \"left\", \"right\").\n4. Examples: {\"active_hands\": [\"right\"]}, {\"active_hands\": [\"left\", \"right\"]}, or {\"active_hands\": []}.\n",
        "user_prompt": "Analyze the provided video frames and identify the active hands.",
        "raw_response": "{\"active_hands\": [\"left\", \"right\"]}",
        "parsed_active_hands": [
          "left",
          "right"
        ]
      },
      "hands": {
        "left": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the LEFT HAND (visible on the left side of the image).\n\nTASK:\nInfer the following attributes for the LEFT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the LEFT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder",
              "contact_region": "rim",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: rim\n\nReference Knowledge Snippets:\n- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is interacting with a paper cup.\nThe provided context states:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: rim\n\nLet's evaluate the provided knowledge snippets:\n\n1.  **Label: Precision:Prismatic_4_Finger**\n    *   Coarse Type: Precision (Matches the general idea of precise manipulation)\n    *   Fine Type: Prismatic 4 Finger (The object is a cylinder, which can be considered prismatic. The virtual fingers are described as 1 vs 2-5, implying multiple fingers are used in opposition to the thumb, which aligns with a 4-finger grasp.)\n    *   Opposition: Pad (Matches)\n    *   Thumb: Abd (Matches)\n    *   Virtual Fingers (VF2): 2-5 (The context states VF2: 1 vs 2-5, which means the thumb (VF1) is opposed by fingers 2-5. This aligns with the snippet's VF2: 2-5.)\n    *   Object Shape: Cylinder (Matches)\n    *   Contact Region: edge/sidewall/face (The context states \"rim\", which is an edge of the cylinder. This is a good match.)\n\n2.  **Label: Precision:Precision_Sphere**\n    *   Coarse Type: Precision (Matches)\n    *   Fine Type: Precision Sphere (The object is a cylinder, not a sphere. This is a mismatch.)\n    *   Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object (Mismatch)\n\nBased on the analysis, **Precision:Prismatic_4_Finger** is the best match. The object is a cylinder, the thumb is abducted, opposition is by pad, and the contact is on the rim (edge). The virtual finger configuration of 1 vs 2-5 also supports a grasp involving multiple fingers opposing the thumb.\n\nFinal Grasp: Precision:Prismatic_4_Finger",
            "parsed_label": "Precision:Prismatic_4_Finger"
          }
        },
        "right": {
          "interaction": {
            "system_prompt": "You are an expert in human grasping and grasp taxonomy.\nFocus ONLY on the RIGHT HAND (visible on the right side of the image).\n\nTASK:\nInfer the following attributes for the RIGHT HAND:\n1) Opposition type:\n   - Palm: Clear surface contact with the palm, thenar, or hypothenar area, bearing or wrapping the object.\n   - Pad: Primary opposition between thumb and other fingers using the pads of the fingertips (front-to-front).\n   - Side: Primary opposition surface comes from the sides of the fingers (lateral, typical for pinching thin sheets or edges).\n2) Thumb position: Abd (abducted/open), Add (adducted/close to palm).\n3) Virtual fingers (VF): Identify digits acting together. Format MUST be either \"VF2: 1 vs 2\" or \"VF2: 1 vs 2-5\".\n4) Object Shape: Select the top 1-3 best fits from: Cavity, Cuboid, Cylinder, Edge, Ellipsoid, Handle, Hole, Knob, Plate, Prismatic, Pull-Tab, Rim, Ring, Ring-Plate, Sheet, Small Ball-like Object, Small Feature, Sphere, Tab, Tapered Cylinder, Torus (comma-separated).\n5) Contact Region: Select the top 1-3 best fits from: edge, rim, sidewall, surface, face (comma-separated).\n\nINSTRUCTIONS:\nOpposition Type (Palm/Pad/Side):\n- Check palm contact first: if the palm/thenar/hypothenar has clear surface contact bearing or wrapping the object, choose \"Palm\".\n- If NOT palm contact, decide between:\n  - \"Pad\" when the primary opposition uses fingertip pads (front-to-front).\n  - \"Side\" when the primary opposition uses lateral finger sides (edge/sheet pinching).\n\nThumb Position (Abd/Add) — evidence-first:\n- First, locate the thumb base and the index base, then estimate the “first web space” (the V-shaped gap between thumb and index).\n- Determine whether the thumb is actively spread outward to oppose other fingers (independent opposing digit) or tucked toward the palm (palmar support).\n- Use the object ONLY to interpret visibility/occlusion (do NOT guess thumb position from grasp category).\nDecision rules:\n- Output \"Abd\" if the thumb-index gap is clearly large AND the thumb is visibly opened outward in an opposition posture.\n- Output \"Add\" if the thumb-index gap is small AND the thumb appears tucked/pressed toward the palm as support.\n- If the thumb base/web space is occluded or contradictory across frames, output \"Unknown\".\n\nVirtual Fingers (VF):\n- Strictly output either \"VF2: 1 vs 2\" (thumb vs index) or \"VF2: 1 vs 2-5\" (thumb vs all fingers).\n- Do not output other variations.\n\nObject Shape + Contact Region:\n- Pick the top 1-3 best fits derived from visual evidence if ambiguous. Use comma to separate them.\n- Contact Region Reasoning Guidelines:\n  - If you see \"Wrapping around a cylinder\" -> prioritize \"sidewall\".\n  - If you see \"Pinching the outer ring of a plate/lid\" -> prioritize \"rim\".\n  - If you see \"Pressing/supporting a flat plane\" -> prioritize \"face\".\n  - If you see \"Contact occurs mainly along a narrow geometric edge or ridge (line-like contact)\" -> prioritize \"edge\". Note: It is NOT a broad face, sidewall, rim, or curved surface.\n  - If you see \"Wrapping around a spherical object\" -> prioritize \"surface\".\n- If the object or contact region is not visible/ambiguous, output \"Unknown\".\n\nTemporal guidance:\n- Integrate evidence across frames internally; prefer the dominant/stable grasp.\n\nOUTPUT:\nReturn ONE valid JSON object ONLY (no extra text):\n{\n  \"opposition_type\": \"Palm|Pad|Side|Unknown\",\n  \"thumb_position\": \"Abd|Add|Unknown\",\n  \"virtual_fingers\": \"string\",\n  \"object_shape\": \"string\",\n  \"contact_region\": \"string\"\n}\n",
            "user_prompt": "Analyze the RIGHT HAND in the provided video frames.",
            "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```",
            "parsed": {
              "opposition_type": "Pad",
              "thumb_position": "Abd",
              "virtual_fingers": "VF2: 1 vs 2-5",
              "object_shape": "Cylinder",
              "contact_region": "rim",
              "raw_response": "```json\n{\n  \"opposition_type\": \"Pad\",\n  \"thumb_position\": \"Abd\",\n  \"virtual_fingers\": \"VF2: 1 vs 2-5\",\n  \"object_shape\": \"Cylinder\",\n  \"contact_region\": \"rim\"\n}\n```"
            }
          },
          "taxonomy": {
            "system_prompt": "You are an expert in Grasp Taxonomy. \nClassify the grasp type based on provided visual context and knowledge snippets.\n\nRULES:\n1) Use the provided attributes + retrieved knowledge as evidence.\n2) Reason step-by-step internally.\n3) Output MUST end with a single line in this exact format: \"Final Grasp: Coarse:Fine\".\n4) Allowed labels: Power:Large_Diameter, Power:Ring, Precision:Prismatic_4_Finger, Precision:Inferior_Pincer, Precision:Precision_Sphere, Intermediate:Lateral, Power:Adducted_Thumb\n",
            "user_prompt": "Context from video:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: rim\n\nReference Knowledge Snippets:\n- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface\n\nIdentify the best matching grasp label from the video frames and context above.\n",
            "knowledge_context": "- Label: Precision:Prismatic_4_Finger\n  Coarse Type: Precision\n  Fine Type: Prismatic 4 Finger\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Cuboid, Prismatic, Plate, Edge, Cylinder, Round Object\n  Contact Region: edge/sidewall/face\n- Label: Precision:Precision_Sphere\n  Coarse Type: Precision\n  Fine Type: Precision Sphere\n  Opposition: Pad\n  Thumb: Abd\n  Virtual Fingers (VF2): 2-5\n  Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object\n  Contact Region: surface",
            "allowed_labels": [
              "Power:Large_Diameter",
              "Power:Ring",
              "Precision:Prismatic_4_Finger",
              "Precision:Inferior_Pincer",
              "Precision:Precision_Sphere",
              "Intermediate:Lateral",
              "Power:Adducted_Thumb"
            ],
            "raw_response": "The user is interacting with a paper cup.\nThe provided context states:\n- Opposition Type: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n- Object Shape: Cylinder\n- Contact Region: rim\n\nLet's evaluate the provided knowledge snippets:\n\n1.  **Label: Precision:Prismatic_4_Finger**\n    *   Coarse Type: Precision (Matches the general idea of precise manipulation)\n    *   Fine Type: Prismatic 4 Finger (The object is a cylinder, which can be considered prismatic. The virtual fingers are described as 1 vs 2-5, implying multiple fingers are used in opposition to the thumb, which aligns with a 4-finger grasp.)\n    *   Opposition: Pad (Matches)\n    *   Thumb: Abd (Matches)\n    *   Virtual Fingers (VF2): 2-5 (The context states VF2: 1 vs 2-5, which means the thumb (VF1) is opposed by fingers 2-5. This aligns with the snippet's VF2: 2-5.)\n    *   Object Shape: Cylinder (Matches)\n    *   Contact Region: edge/sidewall/face (The context states \"rim\", which is an edge of the cylinder. This is a good match.)\n\n2.  **Label: Precision:Precision_Sphere**\n    *   Coarse Type: Precision (Matches)\n    *   Fine Type: Precision Sphere (The object is a cylinder, not a sphere. This is a mismatch.)\n    *   Object Shape: Sphere/Ellipsoid, Knob, Small Ball-like Object (Mismatch)\n\nBased on the analysis, **Precision:Prismatic_4_Finger** is the best match. The object is a cylinder, the thumb is abducted, opposition is by pad, and the contact is on the rim (edge). The virtual finger configuration of 1 vs 2-5 also supports a grasp involving multiple fingers opposing the thumb.\n\nFinal Grasp: Precision:Prismatic_4_Finger",
            "parsed_label": "Precision:Prismatic_4_Finger"
          }
        }
      },
      "description": {
        "system_prompt": "You are a video annotation AI specialized in human manipulation tasks in first-person videos.\n\nTASK: Generate a single-sentence task description summarizing the video.\n\nREQUIREMENTS:\n1. Objects & Affordances: Mention the objects being manipulated, their features, and SPECIFICALLY where they are grasped (functional affordance, e.g., \"the handle of the mug\", \"the rim of the bowl\").\n2. Actions & Spatial Context: Describe the actions (e.g., pick, place, pour) including spatial transitions if visible (e.g., \"from the table to the shelf\", \"out of the box\").\n3. Hands & Grasps: Mention specific hands (left and right) and their inferred grasp types.\n4. Natural Grasp Names: Use the \"natural\" version of the grasp taxonomy (e.g., use \"prismatic 3 finger\" instead of \"Prismatic_3_Finger\"). Integrate it smoothly into the sentence.\n5. Mandatory inclusion: You MUST explicitly mention the grasp type for each active hand.\n6. Style: Imperative style (e.g., \"Use the right hand to...\").\n7. Output format: Plain text only. NO JSON, NO explanations. ONE sentence only.\n\nEXAMPLE:\nUse the right hand with a prismatic 3 finger grasp to pick up the handle of a blue mug and use the left hand with a lateral grasp to steady the mug's base.\n",
        "user_prompt": "Inferred Grasp Attributes for Active Hands:\n\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n\nAnalyze the video and describe the task as requested.\n",
        "raw_response": "Use the left hand with a prismatic 4 finger grasp to pick up the rim of a white paper cup and use the right hand with a prismatic 4 finger grasp to place the lid onto the cup.",
        "context_str": "\n[LEFT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n\n[RIGHT HAND Info]:\n- Grasp Taxonomy (technical): Prismatic_4_Finger\n- Grasp Taxonomy (natural): prismatic 4 finger\n- Opposition: Pad\n- Thumb Position: Abd\n- Virtual Fingers: VF2: 1 vs 2-5\n"
      }
    }
  }
]